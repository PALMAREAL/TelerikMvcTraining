@{
    ViewBag.Title = "ProDropDownList";
}

<style>

    .k-readonly {
        color: gray;
    }

    .selected-value {
        display: inline-block;
        vertical-align: middle;
        width: 24px;
        height: 24px;
        background-size: 100%;
        margin-right: 5px;
        border-radius: 50%;
    }

    #categories-list .k-item {
        line-height: 1em;
        min-width: 300px;
    }

    /* Material Theme padding adjustment*/
    .k-material #categories-list .k-item,
    .k-material #categories-list .k-item.k-state-hover,
    .k-materialblack #categories-list .k-item,
    .k-materialblack #categories-list .k-item.k-state-hover {
        padding-left: 5px;
        border-left: 0;
    }

    #categories-list .k-item > span {
        -webkit-box-sizing: border-box;
        -moz-box-sizing: border-box;
        box-sizing: border-box;
        vertical-align: middle;
        display: table-cell;
        vertical-align: central;
        margin: 10px 10px 10px 5px;
    }

        #categories-list .k-item > span:first-child {
            -moz-box-shadow: inset 0 0 30px rgba(0,0,0,.3);
            -webkit-box-shadow: inset 0 0 30px rgba(0,0,0,.3);
            box-shadow: inset 0 0 30px rgba(0,0,0,.3);
            margin: 10px;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background-size: 100%;
            background-repeat: no-repeat;
        }

    #categories-list h3 {
        font-size: 1.2em;
        font-weight: normal;
        margin: 0 0 1px 0;
        padding: 0;
    }

    #categories-list p {
        margin: 0;
        padding: 0;
        font-size: .8em;
    }

    .center-dropdownlist {
        width: 600px;
        margin-left: auto;
        margin-right: auto;
        margin-top: 80px;
    }
</style>

<div class="center-dropdownlist">

    <div class="demo-section k-content">
        <h4>Categories:</h4>
        @(Html.Kendo().DropDownList()
            .Name("categories")
            .HtmlAttributes(new { style = "width:100%" })
            .OptionLabel("Select category...")
            .DataTextField("CategoryName")
            .DataValueField("CategoryID")
            .Height(310)
            .Template("<span class=\"k-state-default\" style=\"background-image: url(" + Url.Content("~/Content/img/Categories/") + "#:data.CategoryID#.jpg" + ");\" ></span>" +
                "<span class=\"k-state-default\" style=\"padding-left: 15px;\"><h3>#: data.CategoryName #</h3></span>")
            .ValueTemplate("<span class=\"selected-value\" style=\"background-image: url(" + Url.Content("~/Content/img/Categories/") +
                            "#:data.CategoryID#.jpg" + ");\" ></span>" + "<span>#:data.CategoryName#</span>")
            .DataSource(source =>
            {
                source.Read(read =>
                {
                    read.Action("Get_Categories", "Product");
                });
            })
            .FooterTemplate("Total number of <strong>#: instance.dataSource.total() #</strong> categories found")
        )

        <h4 style="margin-top: 2em;">Products:</h4>
        @(Html.Kendo().DropDownList()
                .Name("products")
                .HtmlAttributes(new { style = "width:100%" })
                .OptionLabel("Select product...")
                .DataTextField("ProductName")
                .DataValueField("ProductID")
                .Height(310)
                .Template("<span class=\"k-state-default\" style=\"background-image: url(" + Url.Content("~/Content/img/Products/") + "#:data.ProductID#.jpg" + ");\" ></span>" +
                "<span class=\"k-state-default\" style=\"padding-left: 15px;\"><h3>#: data.ProductName #</h3></span>")
                .ValueTemplate("<span class=\"selected-value\" style=\"background-image: url(" + Url.Content("~/Content/img/Products/") +
                            "#:data.ProductID#.jpg" + ");\" ></span>" + "<span>#:data.ProductName#</span>")
                .DataSource(source => source
                          .Custom()
                          .Type("odata")
                          .ServerFiltering(true)
                          .ServerPaging(true)
                          .PageSize(20)
                          .Transport(transport => transport
                          .Read(read => read.Url("https://demos.telerik.com/kendo-ui/service/Northwind.svc/Products")))
                          )
                .Events(e => e.Change("onChange"))
                .Enable(false)
                .AutoBind(false)
                .CascadeFrom("categories")
        )

        <h4 style="margin-top: 2em;">Orders:</h4>
        @(Html.Kendo().DropDownList()
          .Name("orders")
          .HtmlAttributes(new { style = "width:100%" })
          .OptionLabel("Select order...")
          .DataTextField("ShipCity")
          .DataValueField("OrderID")
           //.DataSource(source =>
           //        {
           //    source.Read(read =>
           //    {
           //        read.Action("Get_Orders", "DropdownList")
           //            .Data("filterOrders");
           //    })
           //    .ServerFiltering(true);
           //})
           .DataSource(source => source
                          .Custom()
                          .Type("odata")
                          .ServerFiltering(true)
                          .ServerPaging(true)
                          .PageSize(20)
                          .Transport(transport => transport
                          .Read(read => read.Url("https://demos.telerik.com/kendo-ui/service/Northwind.svc/Orders").Data("filterOrders")))
                          )
          .Events(e => e.Change("onChange"))
          .Enable(false)
          .AutoBind(false)
          .CascadeFrom("products")
        )

        <button class="k-button k-primary" id="get" style="margin-top: 2em; float: right;">View Order</button>
    </div>
</div>

<script>

    function filterProducts() {
        return {
            categories: $("#categories").val()
        };
    }

    function filterOrders() {
        return {
            products: $("#products").val()
        };
    }

    function onChange(e) {
        var orders = $("#shipTo").data("kendoDropDownList");
        orders.value("");

        if (e.sender.value() == "") {
            orders.enable(false);
        }
        else {
            orders.enable(true);
        }
    }

    $(document).ready(function () {
        var categories = $("#categories").data("kendoDropDownList"),
            products = $("#products").data("kendoDropDownList"),
            orders = $("#orders").data("kendoDropDownList");

        $("#get").click(function () {
            var categoryInfo = "\nCategory: { id: " + categories.value() + ", name: " + categories.text() + " }",
                productInfo = "\nProduct: { id: " + products.value() + ", name: " + products.text() + " }",
                orderInfo = "\nOrder: { id: " + orders.value() + ", name: " + orders.text() + " }";

            alert("Order details:\n" + categoryInfo + productInfo + orderInfo);
        });
    });

</script>
